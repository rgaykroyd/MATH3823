<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert G Aykroyd">
<meta name="dcterms.date" content="2023-05-03">

<title>MATH3823 Solutions to Practical</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="MATH3823 Practical Solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="MATH3823 Practical Solutions_files/libs/quarto-html/quarto.js"></script>
<script src="MATH3823 Practical Solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="MATH3823 Practical Solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MATH3823 Practical Solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="MATH3823 Practical Solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MATH3823 Practical Solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MATH3823 Practical Solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MATH3823 Practical Solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MATH3823 Practical Solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MATH3823 Solutions to Practical</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robert G Aykroyd </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overall-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="overall-conclusions">Overall conclusions</h2>
<p>The probability of having coronary heart disease (CHD) increases as both cholesterol (CHOL) and blood pressure (BP) increase. The explanatory variables CHOL and BP are available as ordinal factors, each observed at 4 levels, although there is no significant evidence of different incidence of CHD at the lowest two levels of either CHOL or BP. In particular, after combining levels 1 and 2 of CHOL and BP, respectively, the incidence of CHD in the population of American males is given in the following table.</p>
<table class="table">
<caption>Proportion of CHD after combining groups</caption>
<thead>
<tr class="header">
<th><strong>CHOL</strong></th>
<th style="text-align: center;">BP Normal/Elevated</th>
<th style="text-align: center;">BP Stage I</th>
<th style="text-align: center;">BP Stage II</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Normal/Medium</strong></td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.14</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><strong>High risk</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><strong>Dangerous</strong></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="initial-exploration-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="initial-exploration-of-the-data">Initial exploration of the data</h2>
<p>Any analysis should start with some general exploration of the data.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>chd <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"https://rgaykroyd.github.io/MATH3823/Datasets/chd.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chd)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> y<span class="sc">/</span>m</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the data </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(chol, p, <span class="at">pch=</span><span class="fu">as.character</span>(bp),     <span class="at">col=</span>bp, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(  bp, p, <span class="at">pch=</span><span class="fu">as.character</span>(chol), <span class="at">col=</span>chol, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-EDA" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-EDA-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/fig-EDA-1.png" class="img-fluid figure-img" data-ref-parent="fig-EDA" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Relationship with CHOL for different BP levels</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-EDA-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/fig-EDA-2.png" class="img-fluid figure-img" data-ref-parent="fig-EDA" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Relationship with BP for different CHOL levels</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Exploratory data plots - Proportion with CHD</figcaption><p></p>
</figure>
</div>
</div>
<p>From <a href="#fig-EDA-1">Figure&nbsp;1 (a)</a> we can see three things.</p>
<ul>
<li><p>The values of p for chol=1 and chol=2 are similar (suggesting combining these factor levels for chol.</p></li>
<li><p>The increase in p from chol=1,2 to chol=3 is about the same as the increase from chol=3 to chol=4 (suggesting replacing a 3-level factor by a quantitative variable).</p></li>
<li><p>It’s difficult to see whether an interaction term will be needed. For any given level of chol, the observed p is about the same for bp = 1 or 2, and the value of p for bp = 4 is always the highest, with the value of p for bp = 3 usually in between (the exception is bp = 3 when chol = 2). Overall, this suggests that an interaction term will probably not be needed.</p></li>
</ul>
<p>A similar interpretation comes from <a href="#fig-EDA-2">Figure&nbsp;1 (b)</a> for p vs.&nbsp;bp. Further the slope in <a href="#fig-EDA-1">Figure&nbsp;1 (a)</a> over chol levels 2–4 is about the same as the slope in <a href="#fig-EDA-2">Figure&nbsp;1 (b)</a> over bp levels 2–4, suggesting that the magnitude of the effects of chol and bp will be similar. We can get similar conclusions from looking at a table of values of p (rounded to 2 d.p.):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">=</span> <span class="fu">matrix</span>(p, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">byrow=</span>T, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste</span>(<span class="st">"chol"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">paste</span>(<span class="st">"bp"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(emp, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       bp 1 bp 2 bp 3 bp 4
chol 1 0.03 0.03 0.06 0.16
chol 2 0.03 0.03 0.02 0.12
chol 3 0.07 0.05 0.10 0.15
chol 4 0.11 0.10 0.20 0.28</code></pre>
</div>
</div>
</section>
<section id="modelling-the-data" class="level2">
<h2 class="anchored" data-anchor-id="modelling-the-data">Modelling the data</h2>
<p>Here is a route to a parsimonious model. It is important to distinguish between qualitative and quantitative variables. I shall use the following notation:</p>
<ul>
<li><p>bf: blood pressure taking 4 levels 1,2,3,4, as a factor.</p></li>
<li><p>b1f blood pressure taking 3 levels 1,1,2,3, as a factor (so the original levels 1 and 2 are combined).</p></li>
<li><p>b2f: blood pressure taking 2 levels 1,1,1,2, as a factor.</p></li>
</ul>
<p>Define similar variables for cholesterol (cf, c1f, c2f) and drop the “f” if the variate is to be regarded as quantitative (b, b1, b2, c, c1, c2).</p>
<p>A sequence of models is fitted at the end of the handout, each simpler than the preceding. For each fitted model it is important to check</p>
<ul>
<li><p>that the deviance is not too big (goodness of fit test), and</p></li>
<li><p>that the increase in deviance from the previous model is not too big for the increase in residual degrees of freedom.</p></li>
</ul>
<p>The models used and the main conclusions from each model are as follows:</p>
<ol type="1">
<li>cf + bf: additive 4-level factors. This model passes the goodness of fit test with p-value 0.97, so we need not consider the saturated model. The parameter estimates for the lowest two factor levels for each of CHOL and BP are very similar (remember that the parameter estimate for the lowest level is constrained to be zero to avoid aliasing). Hence we try combining these levels for each of CHOL and BP. 3 MATH3823 practical solution</li>
<li>c1f + b1f: additive 3-level factors. Comparing the deviances of this model and model 1, the p-value is 0.87, so the simpler model 2 is an adequate description of the data. Note that for each factor the coefficient at level 3 is about twice the coefficient at level 2. Hence we can try replacing the qualitative variables by quantitative variables (point 4 below). First, though, see whether we can simplify to 2-level factors.</li>
<li>c2f + b2f: additive 2-level factors. Unlikely to be valid (as the parameter estimates are not close to each other), but we can try it anyway to make sure. The deviance test confirms that this model is over-simplified (p-value is 0.01) and hence we stick to the 3-level factors.</li>
<li>c1+b1: additive quantitative variables. The deviance test comparing this model to model 2 confirms that this model is still an adequate description of the data (p-value is 0.97).</li>
<li>Note the coefficients for c1 and b1 in model 4 are about equal (each is within one standard error of the other). Hence combine them into a single score (and shift the score for simplicity so that it equals 0 for the lowest factor levels). Thus, we have the simple model where the response depends on score, where score is a quantitative variable defined by score = c1 + b1 - 2. The deviance test comparing this model to the previous one indicates that this model is still an adequate description of the data (p-value is 0.93).</li>
</ol>
<p>A surprising feature of this analysis is that each simplification of the model introduces such a small change to the deviance. You can also compare the deviances of your chosen model with the different link functions (logit, probit, complementary log-log). There is little difference in the deviances (remember we can’t do a formal test as the model has the same number of parameters). Hence, any choice of the link function is acceptable here. The probit has a slightly lower deviance, so that would be a good choice. I have chosen to use the logit link function as this is the canonical link and is the most widely used.</p>
</section>
<section id="residual-plots" class="level2">
<h2 class="anchored" data-anchor-id="residual-plots">Residual plots</h2>
<p>For any seriously entertained model you should plot the residuals to make sure that the model is not missing any important structure. For the above models there are no large residuals for this example.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">=</span> <span class="fu">cbind</span>(y,m<span class="sc">-</span>y)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> c1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> b1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> score <span class="ot">=</span> c1<span class="sc">+</span>b1<span class="dv">-2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> m5 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> score, <span class="at">family =</span> binomial)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a> res <span class="ot">=</span> <span class="fu">residuals</span>(m5, <span class="st">"pearson"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a> fv <span class="ot">=</span> <span class="fu">fitted.values</span>(m5)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(fv, res, <span class="at">xlab =</span> <span class="st">"Fitted values"</span>, <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(score, res, <span class="at">xlab =</span> <span class="st">"Score"</span>, <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-resids" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-resids-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/fig-resids-1.png" class="img-fluid figure-img" data-ref-parent="fig-resids" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Relationship with fitted values</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-resids-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/fig-resids-2.png" class="img-fluid figure-img" data-ref-parent="fig-resids" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Relationship with explanatory variable</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Model residual plots</figcaption><p></p>
</figure>
</div>
</div>
<p><a href="#fig-resids-1">Figure&nbsp;2 (a)</a> and <a href="#fig-resids-2">Figure&nbsp;2 (b)</a> are plots of the residuals for model 5, plotted against the fitted values and the values of <em>score</em> respectively. None of the residuals are worrying. One residual stands out slightly - the residual with the largest magnitude, about 1.5.</p>
</section>
<section id="final-point" class="level2">
<h2 class="anchored" data-anchor-id="final-point">Final point</h2>
<p>For the low levels of BP and CHOL there are very few cases of CHD. Thus it is difficult to make any strong statement about how probabilities depend on level. The best we can say is that there is not enough data to enable us to distinguish the differences between levels 1 and 2 for CHOL and BP, respectively.</p>
</section>
<section id="r-code-appendix" class="level2">
<h2 class="anchored" data-anchor-id="r-code-appendix">R code Appendix</h2>
<p>This appendix contain the <strong>R</strong> code used to produce these <em>Solution</em> but they are not meant to represent the best solution and there are always other ways to organize code and to perform a valid analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MATH3823 Practical Assessment 2022-23</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (C) RGA 03/05/2023</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>chd <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"https://rgaykroyd.github.io/MATH3823/Datasets/chd.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from chd (pos = 3):

    bp, chol, m, y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">=</span> <span class="fu">cbind</span>(y,m<span class="sc">-</span>y)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> y<span class="sc">/</span>m</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the data.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chol, p, <span class="at">pch=</span><span class="fu">as.character</span>(bp),     <span class="at">col=</span>bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(  bp, p, <span class="at">pch=</span><span class="fu">as.character</span>(chol), <span class="at">col=</span>chol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulate empirical values of "p".</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">=</span> <span class="fu">matrix</span>(p, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">byrow=</span>T, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste</span>(<span class="st">"chol"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">paste</span>(<span class="st">"bp"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(emp, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       bp 1 bp 2 bp 3 bp 4
chol 1 0.03 0.03 0.06 0.16
chol 2 0.03 0.03 0.02 0.12
chol 3 0.07 0.05 0.10 0.15
chol 4 0.11 0.10 0.20 0.28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up explanatory variables as factors.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cf <span class="ot">=</span> <span class="fu">as.factor</span>(chol); bf <span class="ot">=</span> <span class="fu">as.factor</span>(bp)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Try main effects model first.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a> m1 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> cf <span class="sc">+</span> bf, <span class="at">family =</span> binomial)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = resp ~ cf + bf, family = binomial)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.85988  -0.15141  -0.00509   0.21420   0.76171  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -3.2868     0.3242 -10.137  &lt; 2e-16 ***
cf2          -0.1522     0.4252  -0.358 0.720419    
cf3           0.5424     0.3280   1.654 0.098208 .  
cf4           1.2123     0.3243   3.738 0.000185 ***
bf2          -0.1121     0.2880  -0.389 0.697236    
bf3           0.5165     0.3144   1.643 0.100460    
bf4           1.1917     0.3109   3.833 0.000127 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.0260  on 15  degrees of freedom
Residual deviance:  2.8017  on  9  degrees of freedom
AIC: 71.415

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do goodness of fit test (statistic and degrees of freedom from output).</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">pchisq</span>(<span class="fl">2.8017</span>, <span class="at">df =</span> <span class="dv">9</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9716406</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine levels 1 &amp; 2 of each factor.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a> c1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a> b1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(  bp<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a> c1f <span class="ot">=</span> <span class="fu">as.factor</span>(c1); b1f <span class="ot">=</span> <span class="fu">as.factor</span>(b1)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a> m2 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> c1f <span class="sc">+</span> b1f, <span class="at">family =</span> binomial)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = resp ~ c1f + b1f, family = binomial)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.97750  -0.20493   0.00219   0.15582   0.86466  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -3.4128     0.2277 -14.989  &lt; 2e-16 ***
c1f2          0.6010     0.2747   2.188   0.0287 *  
c1f3          1.2733     0.2705   4.707 2.52e-06 ***
b1f2          0.5814     0.2686   2.164   0.0304 *  
b1f3          1.2550     0.2640   4.753 2.00e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.0260  on 15  degrees of freedom
Residual deviance:  3.0845  on 11  degrees of freedom
AIC: 67.698

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare this model with previous.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">pchisq</span>(<span class="fl">3.0845</span> <span class="sc">-</span> <span class="fl">2.8017</span>, <span class="dv">11</span> <span class="sc">-</span> <span class="dv">9</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.868142</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulate empirical values of "p" after combining levels.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a> y.M2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">+</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>, <span class="dv">4</span><span class="sc">+</span><span class="dv">3</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>          <span class="dv">9</span><span class="sc">+</span><span class="dv">12</span>,      <span class="dv">7</span>,   <span class="dv">7</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>          <span class="dv">8</span><span class="sc">+</span><span class="dv">11</span>,     <span class="dv">11</span>,  <span class="dv">12</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a> m.M2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">118</span><span class="sc">+</span><span class="dv">122</span><span class="sc">+</span><span class="dv">89</span><span class="sc">+</span><span class="dv">102</span>, <span class="dv">52</span><span class="sc">+</span><span class="dv">41</span>, <span class="dv">25</span><span class="sc">+</span><span class="dv">24</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">126</span><span class="sc">+</span><span class="dv">219</span>, <span class="dv">73</span>, <span class="dv">48</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">75</span><span class="sc">+</span><span class="dv">112</span>, <span class="dv">56</span>, <span class="dv">43</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> y.M2<span class="sc">/</span>m.M2</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">=</span> <span class="fu">matrix</span>(p2, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">byrow=</span>T, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste</span>(<span class="st">"chol"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="fu">paste</span>(<span class="st">"bp"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(emp, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       bp 1 bp 2 bp 3
chol 1 0.03 0.04 0.14
chol 2 0.06 0.10 0.15
chol 3 0.10 0.20 0.28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All ok so far.  Combine more levels.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> c2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(chol<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a> b2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(bp<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(bp<span class="sc">==</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(bp<span class="sc">==</span><span class="dv">3</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(bp<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a> c2f <span class="ot">=</span> <span class="fu">as.factor</span>(c2); b2f <span class="ot">=</span> <span class="fu">as.factor</span>(b2)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a> m3 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> c2f <span class="sc">+</span> b2f, <span class="at">family =</span> binomial)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = resp ~ c2f + b2f, family = binomial)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.2834  -0.7523  -0.2119   0.3573   1.6690  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -2.9745     0.1447 -20.555  &lt; 2e-16 ***
c2f2          0.9846     0.2172   4.533 5.82e-06 ***
b2f2          1.1286     0.2523   4.472 7.74e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.026  on 15  degrees of freedom
Residual deviance: 12.300  on 13  degrees of freedom
AIC: 72.913

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare this model with previous.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">pchisq</span>(<span class="fl">12.3</span> <span class="sc">-</span> <span class="fl">3.0845</span>, <span class="dv">13</span> <span class="sc">-</span> <span class="dv">11</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.009974235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Significant difference - revert to model 2.  </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Try converting factors to quantitative variables</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and compare to model 2.</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a> m4 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> c1 <span class="sc">+</span> b1, <span class="at">family =</span> binomial)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = resp ~ c1 + b1, family = binomial)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0023  -0.1816  -0.0361   0.1929   0.9160  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.6981     0.3644 -12.894  &lt; 2e-16 ***
c1            0.6392     0.1349   4.738 2.16e-06 ***
b1            0.6232     0.1295   4.811 1.50e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.0260  on 15  degrees of freedom
Residual deviance:  3.1399  on 13  degrees of freedom
AIC: 63.753

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">pchisq</span>(<span class="fl">3.1399</span> <span class="sc">-</span> <span class="fl">3.0845</span>, <span class="dv">13</span> <span class="sc">-</span> <span class="dv">11</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9726801</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the deviances using the different link functions.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">deviance</span>(<span class="fu">glm</span>(resp <span class="sc">~</span> c1 <span class="sc">+</span> b1, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.13989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">deviance</span>(<span class="fu">glm</span>(resp <span class="sc">~</span> c1 <span class="sc">+</span> b1, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.085097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">deviance</span>(<span class="fu">glm</span>(resp <span class="sc">~</span> c1 <span class="sc">+</span> b1, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"cloglog"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.236547</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the effects of chol and bp into one "risk score".</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a> score <span class="ot">=</span> c1<span class="sc">+</span>b1<span class="dv">-2</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a> m5 <span class="ot">=</span> <span class="fu">glm</span>(resp <span class="sc">~</span> score, <span class="at">family =</span> binomial)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = resp ~ score, family = binomial)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.01802  -0.16693  -0.04974   0.18385   0.88413  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.43155    0.19443 -17.650  &lt; 2e-16 ***
score        0.63089    0.09015   6.998 2.59e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.0260  on 15  degrees of freedom
Residual deviance:  3.1468  on 14  degrees of freedom
AIC: 61.76

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">pchisq</span>(<span class="fl">3.1468</span> <span class="sc">-</span> <span class="fl">3.1399</span>, <span class="dv">14</span> <span class="sc">-</span> <span class="dv">13</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9337989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, look at residuals to check there are no problems.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a> res <span class="ot">=</span> <span class="fu">residuals</span>(m5, <span class="st">"pearson"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a> fv <span class="ot">=</span> <span class="fu">fitted.values</span>(m5)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">cbind</span>(res, chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           res  y   m chol bp
1  -0.36794752  3 118    1  1
2   0.09275957  4 122    1  2
3   0.01252784  3  52    1  3
4   0.94793440  4  25    1  4
5   0.12910605  3  89    2  1
6  -0.11087053  3 102    2  2
7  -0.90644689  1  41    2  3
8   0.36345696  3  24    2  4
9   0.68298521  9 126    3  1
10 -0.15881956 12 219    3  2
11 -0.18613329  7  73    3  3
12 -0.56062942  7  48    3  4
13  0.11903116  8  75    4  1
14 -0.14946735 11 112    4  2
15  0.38713053 11  56    4  3
16 -0.12083640 12  43    4  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(fv, res, <span class="at">xlab =</span> <span class="st">"Fitted values"</span>, <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(score, res, <span class="at">xlab =</span> <span class="st">"Score"</span>, <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MATH3823-Practical-Solutions_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>
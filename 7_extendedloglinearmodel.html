<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH3823 Generalized Linear Models - 7&nbsp; Extensions to Loglinear models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./6_loglinearmodel.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Extensions to Loglinear models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH3823 Generalized Linear Models</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Weekly schedule</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0_preface.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_linearmodels.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Essentials of Normal Linear Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_GLM-Theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GLM Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_GLM-Fitting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">GLM Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_logisticmodel.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling Proportions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_loglinearmodel.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Loglinear Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_extendedloglinearmodel.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Extensions to Loglinear models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="toc-section-number">7.1</span>  Overview</a></li>
  <li><a href="#contingency-tables-with-fixed-marginals" id="toc-contingency-tables-with-fixed-marginals" class="nav-link" data-scroll-target="#contingency-tables-with-fixed-marginals"><span class="toc-section-number">7.2</span>  Contingency tables with fixed marginals</a></li>
  <li><a href="#product-multinomial-models" id="toc-product-multinomial-models" class="nav-link" data-scroll-target="#product-multinomial-models"><span class="toc-section-number">7.3</span>  Product-multinomial models</a></li>
  <li><a href="#model-fitting-in-r" id="toc-model-fitting-in-r" class="nav-link" data-scroll-target="#model-fitting-in-r"><span class="toc-section-number">7.4</span>  Model fitting in <strong>R</strong></a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">7.5</span>  Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Extensions to Loglinear models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="overview" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">7.1</span> Overview</h2>
<p>In the melanoma example, see <a href="6_loglinearmodel.html#tbl-melanomacount1">Table&nbsp;<span>6.2</span></a>, the overall total number of observations was exactly <span class="math inline">\(400\)</span>. If the data were truly Poisson, this would be a suspiciously round number. In reality, this total was fixed by design, so we should take into account the fact that <span class="math inline">\(y_{++} = 400\)</span> and fit a more appropriate model. Also, recall the flu vaccine example of <a href="6_loglinearmodel.html#tbl-flucount">Table&nbsp;<span>6.5</span></a>. Suppose that some of the marginal totals are fixed by design. For example, that the number of patients in each arm of the trial (38 in the Placebo group, 35 in the Vaccine group) was fixed before data collection started. In this case, we should also take into account the fact that <span class="math inline">\(y_{1+}=38\)</span> and <span class="math inline">\(y_{2+}=35\)</span> and fit a more suitable model.</p>
<p>Before we can re-consider these data sets, we first need to establish some theoretical results to deal with such <em>conditional distribution</em> cases.</p>
</section>
<section id="contingency-tables-with-fixed-marginals" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="contingency-tables-with-fixed-marginals"><span class="header-section-number">7.2</span> Contingency tables with fixed marginals</h2>
<p>Consider, again, a general two-way contingency table such as that in <a href="#tbl-twoway2">Table&nbsp;<span>7.1</span></a>. The fixed marginals are the column sums: <span class="math inline">\(y_{+j},\)</span> the row sums: <span class="math inline">\(y_{i+},\)</span> and the overall sum: <span class="math inline">\(y_{++}.\)</span></p>
<div id="tbl-twoway2" class="anchored">
<table class="table">
<caption>Table&nbsp;7.1: A two-way contingency table with <span class="math inline">\(k_1\)</span> rows and <span class="math inline">\(k_2\)</span> columns, where each entry <span class="math inline">\(y_{ij}\)</span> is a count.</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;"><span class="math inline">\(\dots\)</span></th>
<th style="text-align: center;"><span class="math inline">\(j\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\dots\)</span></th>
<th style="text-align: center;"><span class="math inline">\(k_2\)</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(y_{11}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{1j}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{1k_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{1+}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{i1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{1j}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{ik_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{i+}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(k_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{k_11}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{k_12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{k_1j}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{k_1k_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{k_1+}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">\(y_{+1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{+2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{+j}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{+k_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{++}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>Suppose that we have fixed row totals <span class="math inline">\(y_{i+},\)</span> or a fixed overall total <span class="math inline">\(y_{++}\)</span>, how would such constraints affect the distribution of the random variables <span class="math inline">\(Y_{ij}\)</span>?<br>
To answer this question, we will need the following results.</p>
<div id="prp-poissonsums1" class="proposition theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7.1 </strong></span>Let <span class="math inline">\(Y_{ij}\)</span>, for <span class="math inline">\(i=1,\dots,k_1\)</span> and <span class="math inline">\(j=1,\dots, k_2\)</span>, be the responses in a two-way contingency table, with <span class="math inline">\(k_1\)</span> rows and <span class="math inline">\(k_2\)</span> columns. Further, assume that the counts follow independent Poisson distributions with corresponding means <span class="math inline">\(\lambda_{ij}\)</span>, that is <span class="math inline">\(Y_{ij}\sim \mbox{Po}(\lambda_{ij})\)</span>. Then, the distributions of the row sums are, <span class="math display">\[
Y_{i+} \sim \mbox{Po}(\lambda_{i+}),
\]</span> where <span class="math inline">\(\displaystyle Y_{i+} = \sum_{j=1}^{k_2} Y_{ij}\)</span> and <span class="math inline">\(\displaystyle \lambda_{i+}=\sum_{j=1}^{k_2} \lambda_{ij}\)</span>.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>Here we are not yet assuming that the marginal totals are fixed.</li>
<li>Similar results hold when considering column sums and the overall sum.</li>
</ul>
</div>
<p><strong>Proof:</strong> See MATH2715, Chapter 7 on <em>MGF Properties of Linear Functions</em>.</p>
<div id="prp-poissonsums2" class="proposition theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7.2 </strong></span>Let <span class="math inline">\(Y_{ij}\sim \mbox{Po}(\lambda_{ij})\)</span> for <span class="math inline">\(i=1,\dots,k_1\)</span> and <span class="math inline">\(j=1,\dots, k_2\)</span> then the conditional distribution of each count in a row given that the row sum is fixed is given by <span class="math display">\[
\left( Y_{ij} \, |\,   Y_{i+} = m \right)
\sim
\mbox{Bin}\left(m,
\frac{\lambda_{ij}}{\lambda_{i+}}
\right).
\]</span> That is, conditioning on the sum of independent Poisson random variables induces a Binomial distribution.</p>
</div>
<p><strong>Proof:</strong> First define <span class="math inline">\(Y_{i-j}= Y_{i+}-Y_{ij}\)</span> with correspondingly <span class="math inline">\(y_{i-j}= m-y_{ij}\)</span> and also <span class="math inline">\(\lambda_{i-j}= \lambda_{i+}-\lambda_{ij}\)</span>.</p>
<p>Consider the conditional probability mass function <span class="math display">\[\begin{align*}
p(Y_{ij} = y_{ij} | Y_{i+} = m)  
&amp; = \frac{p(Y_{ij} = y_{ij}, Y_{i+} = m)} {p(Y_{i+} = m)}
\quad \text{by conditional probability definition}\\
&amp; = \frac{p(Y_{ij} = y_{ij}, Y_{i-j} = m-y_{ij})} {p(Y_{i+} = m)} \quad \text{rearranging} \\
&amp; = \frac{p(Y_{ij} = y_{ij})p(Y_{i-j} = m-y_{ij})} {p(Y_{i+} = m)} \quad \text{by independence}.
\end{align*}\]</span> Then, each of these follows a Poisson distribution: <span class="math inline">\(Y_{ij} \sim \text{Po}(\lambda_{ij})\)</span>, <span class="math inline">\(Y_{i-j}\sim \text{Po}(\lambda_{i-j})\)</span>, and <span class="math inline">\(Y_{i+} \sim \text{Po}(\lambda_{i+})\)</span>. Therefore, <span class="math display">\[\begin{align*}
p(Y_{ij} = y_{ij} | Y_{i+} = m)  
&amp; =
\frac{\lambda_{ij}^{y_{ij}}e^{-\lambda_{ij}}}{y_{ij}!}
\frac{\lambda_{i-j}^{m-y_{ij}}e^{-\lambda_{i-j}}}{m-y_{ij}!}
\Bigg/
\frac{\lambda_{i+}^{m} e^{-\lambda_{i+}}}{m!} \\
&amp; =
{m \choose y_{ij}}
\left(\frac{\lambda_{ij}}{\lambda_{i+}} \right) ^{y_{ij}}
\left(\frac{\lambda_{i-j}}{\lambda_{i+}} \right) ^{m-y_{ij}}\\
&amp; =
{m \choose y_{ij}}
\pi ^{y_{ij}}
\left(1-\pi\right) ^{m-y_{ij}}
\end{align*}\]</span></p>
<p>which is the probability mass function of a <span class="math inline">\(\text{Bin}(m, \pi)\)</span> random variable, where <span class="math inline">\(\pi = \lambda_{ij} / \lambda_{i+}\)</span>.</p>
<div id="prp-poissonsums3" class="proposition theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7.3 </strong></span>Let <span class="math inline">\(Y_{ij}\sim \mbox{Po}(\lambda_{ij})\)</span> for <span class="math inline">\(i=1,\dots,k_1\)</span> and <span class="math inline">\(j=1,\dots, k_2\)</span> then the <strong>joint</strong> conditional distribution of the counts in a row given that the row sum is fixed is given by <span class="math display">\[
p(Y_{i1},\dots, Y_{i k_2} \, | \, Y_{i+}=m)
=
\frac{m!}{y_{i1}!\cdots y_{i k_2}!}
\pi_{i1}^{y_{i1}} \cdots\pi_{ik_2}^{y_{ik_2}}
\]</span> with <span class="math display">\[
\pi_{ij}=\lambda_{ij}/\lambda_{i+}
\quad \mbox{ and } \quad
\sum_{j=1}^{k_2} \pi_{ij} =1.
\]</span> This distribution is called the <em>Multinomial</em> distribution, with index <span class="math inline">\(m\)</span> and parameters <span class="math inline">\(\pi_{ij}, j=1,\dots k_2\)</span>, which can be denoted <span class="math display">\[
(Y_{i1},\dots, Y_{i k_2} \, | \, Y_{i+}=m)
\sim
\text{Mult}(m, \pi_{i1}, \dots \pi_{ik_2}
).
\]</span></p>
</div>
<p><strong>Proof:</strong> Omitted.</p>
<div id="prp-poissonsums4" class="proposition theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7.4 </strong></span>Let <span class="math inline">\(Y_{ij}\sim \mbox{Po}(\lambda_{ij})\)</span> for <span class="math inline">\(i=1,\dots,k_1\)</span> and <span class="math inline">\(j=1,\dots, k_2\)</span> then the conditional distribution of the counts given that the overall sum is fixed is <span class="math display">\[
(Y_{11},\dots, Y_{k_1k_2} \, | \, Y_{++}=m)
\sim
\text{Mult}(m, \pi_{11},\dots, \pi_{k_1k_2}).
\]</span> with probability mass function given by <span class="math display">\[
p(Y_{11},\dots, Y_{k_1k_2} \, | \, Y_{++}=m)
=
\frac{m!}{y_{11}!\cdots y_{k_1k_2}!}
\pi_1^{y_1} \cdots\pi_{k_1k_2}^{y_{k_1k_2}}
\]</span> where <span class="math inline">\(\pi_{ij} = \lambda_{ij}/\lambda_{++}\)</span>.</p>
</div>
<p><strong>Proof:</strong> Omitted.</p>
</section>
<section id="product-multinomial-models" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="product-multinomial-models"><span class="header-section-number">7.3</span> Product-multinomial models</h2>
<p>To be added soon.</p>
</section>
<section id="model-fitting-in-r" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="model-fitting-in-r"><span class="header-section-number">7.4</span> Model fitting in <strong>R</strong></h2>
</section>
<section id="exercises" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">7.5</span> Exercises</h2>
<p>To be added later.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./6_loglinearmodel.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Loglinear Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>